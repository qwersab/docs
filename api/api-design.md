# API 设计规范文档

## 概述
本文档描述了校园二手交易平台的API设计规范，包括RESTful API设计原则、资源关系、通用模式、安全认证等内容。

## RESTful API 设计
在线预览：https://apifox.com/apidoc/shared-077483db-ef3c-4a28-8611-49c64dcab047
### 基本原则
1. 使用HTTP方法表示操作语义
   - GET: 获取资源
   - POST: 创建资源
   - PUT: 更新资源
   - DELETE: 删除资源

2. 使用名词复数形式表示资源集合
   - `/users` - 用户集合
   - `/products` - 商品集合
   - `/orders` - 订单集合

3. 使用嵌套路由表示资源关系
   - `/products/{productId}/comments` - 商品的评论
   - `/users/{userId}/orders` - 用户的订单

### 资源关系
1. 用户(User)
   - 发布商品
   - 创建订单
   - 发表评论
   - 进行互动

2. 商品(Product)
   - 属于分类(Category)
   - 包含评论(Comment)
   - 关联订单(Order)
   - 记录互动(Interaction)

3. 订单(Order)
   - 关联商品
   - 关联用户
   - 包含交易状态

### 通用模式

#### 响应格式
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    // 具体数据
  }
}
```

#### 错误处理
```json
{
  "code": 400,
  "message": "错误信息",
  "errors": [
    {
      "field": "字段名",
      "message": "具体错误"
    }
  ]
}
```

#### 分页参数
- `page`: 页码（从1开始）
- `size`: 每页数量
- `total`: 总记录数

#### 过滤参数
- 支持按状态过滤
- 支持按时间范围过滤
- 支持按价格区间过滤

### 安全认证

#### JWT认证
1. 请求头格式
```
Authorization: Bearer <token>
```

2. Token结构
```json
{
  "sub": "用户ID",
  "exp": "过期时间",
  "iat": "签发时间"
}
```

3. 安全措施
- Token有效期控制
- 敏感数据加密
- 请求频率限制

### 数据验证

#### 请求参数验证
1. 必填字段检查
2. 数据类型验证
3. 格式验证（如邮箱、手机号）
4. 业务规则验证

#### 响应数据验证
1. 数据完整性检查
2. 敏感信息过滤
3. 数据格式统一

## 开发工具

### API文档工具
1. Swagger UI
   - 可视化API文档
   - 在线调试功能
   - 支持导出文档

2. OpenAPI Generator
   - 生成服务端代码
   - 生成客户端代码
   - 支持多种语言

### 测试工具
1. Postman
   - 接口测试
   - 环境配置
   - 测试用例管理

2. 自动化测试
   - 单元测试
   - 集成测试
   - 性能测试

## 最佳实践

### 命名规范
1. URL命名
   - 使用小写字母
   - 单词间用连字符(-)分隔
   - 使用复数形式

2. 参数命名
   - 使用驼峰命名
   - 语义化命名
   - 避免缩写
